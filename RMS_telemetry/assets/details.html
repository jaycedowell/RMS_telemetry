<!DOCTYPE html>
<html lang='en' xml:lang='en' xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>RMS_telemetry</title>
  <link rel="icon" href="/images/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font/font-awesome.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script type="text/javascript">
  function updateListing(response, status, xhr) {
    var tbl = document.getElementById('listing');
    if( tbl != null ) {
      var contents = '<thead><tr><th>Date</th><th>Magnitude</th><th>Duration</th><th>Shower</th><th>Link</th></thead>';
      contents += '<tbody>';
      for(var idx in response) {
        var entry = response[idx];
        contents += '<tr><td>' + entry['date'] + '</td>';
        contents += '<td>' + entry['mag'].toString() + '</td>';
        contents += '<td>' + entry['dur'].toString() + ' s</td>';
        contents += '<td>' + entry['shower'] + '</td>';
        contents += '<td><a href="/previous/meteor?date=' + entry['date'] + '>Image</a></td></tr>';
      }
      contents += '</tbody>';
    }
    
    tbl.innerHTML = contents;
  }
  
  function fetchListing() {
    var url = '/previous/details'
    
    var parts = window.location.href.split("?");
    if( parts.size == 2) {
      url += parts[1];
    }
    
    $.ajax({'url': url,
            'success': function(response, status, xhr) {
              updateListing(response, status, xhr);
            },
            'error': function() {
              setTimeout(fetchListing, 5000);
            }
           });
  }
  </script>
</head>
<body onload="fetchListing();">
  <table id="listing"></table>
</body>
</html>
